FROM php:8.2-cli

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
RUN apt-get update && apt-get install -y \
    unzip zip curl git sqlite3 libsqlite3-dev libzip-dev libpng-dev libjpeg62-turbo-dev libfreetype6-dev \
    && docker-php-ext-configure gd --with-freetype --with-jpeg \
    && docker-php-ext-install gd pdo pdo_sqlite zip

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Composer
COPY --from=composer:2 /usr/bin/composer /usr/bin/composer

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
WORKDIR /app

# –ö–æ–ø–∏—Ä—É–µ–º –ø—Ä–æ–µ–∫—Ç
COPY . .

# üí• –ö–æ–ø–∏—Ä—É–µ–º .env –æ—Ç–¥–µ–ª—å–Ω–æ (—ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ!)
COPY .env .env

# Laravel dependencies
RUN composer install --no-dev --optimize-autoloader

EXPOSE 10000

CMD php artisan serve --host=0.0.0.0 --port=10000
